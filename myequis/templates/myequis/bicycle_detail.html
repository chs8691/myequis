{% load static %}
{% load humanize %}

<link rel="stylesheet" type="text/css" href="{% static 'myequis/style.css' %}">

<h2>{{ bicycle.name }}</h2>

<div class="clearfix">
    <div class="button-line-flex-container">
        <a class="nav-button" href="{% url 'myequis:index-url' %}">Home</a>
    </div>
</div>

<h3>Last Records</h3>

<div class="clearfix">
    <div class="button-line-flex-container">
        <a class="nav-button" href="{% url 'myequis:list-records-url' bicycle.id %}">Manage</a>
    </div>
</div>

<div>
{% if records %}
    <table>
        <thead>
            <tr>
                <th>Date</th>
                <th>Value</th>
            </tr>
        </thead>
        {% for record in records %}
            <tr>
                <td><span>Date</span>{{ record.date }}</td>
                <td><span>Value</span>{{ record.km }}</td>
            </tr>
        {% endfor %}
    </table>
{% else %}
    <p>No records yet</p>
{% endif %}
</div>

<h3>Components in Usage</h3>

<div class="clearfix">
    <div class="button-line-flex-container">
        <a class="nav-button" href="{% url 'myequis:list-bicycle-history-url' bicycle.id %}">History</a>
        <a class="nav-button" href="{% url 'myequis:list-bicycle-parts-url' bicycle.id %}">Manage</a>
    </div>
</div>

<div>
{% if componentDataList %}
    {% for componentData in componentDataList %}
        {% if componentData.has_materials %}
            <h4>{{ componentData.component_name }}</h4>
            <table>
                <thead>
                    <tr>
                        <th>Part</th>
                        <th>Material</th>
                        <th>Mounted at</th>
                        <th>KM</th>
                    </tr>
                </thead>
                {% for part in componentData.parts %}
                    {% if part.material %}
                        <tr>
                            <td><span>Part</span>{{ part.part.name }}</td>
                            <td><span>Material</span>{{ part.material.name }}</td>
                            <td><span>Mounted at</span>{{ part.mounting.mount_record.date }}</td>
                            <td><span>KM</span>{{ part.distance }}</td>
                        </tr>
                    {% endif %}
                {% endfor %}
            </table>
        {% endif %}
    {% endfor%}
{% else %}
    <p>No components with parts with mounted materials yet</p>
{% endif %}
</div>

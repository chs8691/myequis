{% extends "base.html" %}

{% block nav-items %}
{% endblock %}


{% block main %}

{% with var=bicycle.name|add:" Parts"  %}
{% include "page-title.html" with title=var  %}
{% endwith %}


<div>
  {% if data_list %}
  {% for data in data_list %}

  {% url 'myequis:bicycle-detail-url' bicycle.id as back_url %}
  {% if not data.prev %}
  {% firstof "disabled" as prev_status  %}
  {% else %}
  {% firstof "" as prev_status  %}
  {% endif %}

  {% if not data.next %}
  {% firstof "disabled" as next_status  %}
  {% else %}
  {% firstof "" as next_status  %}
  {% endif %}

  {% include "nav-line.html" with title=data.name back_url=back_url prev_url=data.prev prev_status=prev_status next_url=data.next next_status=next_status %}


  <div class="table-responsive">
    <table class="table table-hover">
      <thead>
        <tr>
          <th scope="col">Part</th>
          <th scope="col">Material</th>
          <th scope="col">Mounted at</th>
          <th scope="col">KM</th>
        </tr>
      </thead>
      {% for part in data.parts %}
      <tr>

        {% if part.material %}
        <td onclick="tdClick('{% url 'myequis:exchange-material-url' bicycle.id part.part.id %}');">
          {{ part.part.name }}
        </td>
        {% else %}
        <td onclick="tdClick('{% url 'myequis:mount-material-url' bicycle.id part.part.id %}');">
          {{ part.part.name }}
        </td>
        {% endif %}

        {% if part.material %}
        <td onclick="tdClick('{% url 'myequis:material-detail-url' part.material.id %}');">
          <div class="text-uppercase">
            {{ part.material.manufacture }}
          </div>
          <div class="font-weight-bold">
            <span>
              {{ part.material.name }}
            </span>
          </div>
          <div class="text-muted">
            <div>
              {{ part.material.comment }}
            </div>
            <div>
              {{ part.mounting.comment }}
            </div>
          </div>
        </td>
        {% else %}
        <td>{{ part.material.name }}</td>
        {% endif %}

        <td>{{ part.mounting.mount_record.date }}</td>
        <td>{{ part.distance }}</td>
      </tr>
      {% endfor %}
    </table>
    {% endfor%}
    {% else %}
    <p>No components yet</p>
    {% endif %}
  </div>
</div>

{% endblock %}

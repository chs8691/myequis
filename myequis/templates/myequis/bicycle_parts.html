{% extends "base.html" %}

{% block nav-items %}
{% endblock %}


{% block main %}

{% with var=bicycle.name|add:" Parts"  %}
{% include "page-title.html" with title=var  %}
{% endwith %}


<div>
  {% if data_list %}
  {% for data in data_list %}

  {% include "article-title.html" with title=data.name id=data.name %}

  {% include "nav-open.html" %}
  {% url 'myequis:bicycle-detail-url' bicycle.id as nav_url %}
  {% include "nav-item.html" with url=nav_url title="Back" %}


  <li class="nav-item">

    {% if data.prev %}
    {% firstof "" as status  %}
    {% else %}
    {% firstof "disabled" as status  %}
    {% endif %}
    <a class='btn btn-outline-primary mr-2 {{ status }}' href='#{{ data.prev }}'>
      <div class="text-primary">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-caret-up-fill" viewBox="0 0 16 16">
          <path d="m7.247 4.86-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z"/>
        </svg>
      </div>
    </a>
  </li>

  <li class="nav-item">
    {% if data.next %}
    {% firstof "" as status  %}
    {% else %}
    {% firstof "disabled" as status  %}
    {% endif %}
    <a class='btn btn-outline-primary mr-2 {{status}}' href='#{{ data.next }}'>
      <div class="text-primary">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-caret-down-fill" viewBox="0 0 16 16">
          <path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"/>
        </svg>
      </div>
    </a>
  </li>


  {% include "nav-close.html" %}


  <div class="table-responsive">
    <table class="table table-hover">
      <thead>
        <tr>
          <th scope="col">Part</th>
          <th scope="col">Material</th>
          <th scope="col">Mounted at</th>
          <th scope="col">KM</th>
        </tr>
      </thead>
      {% for part in data.parts %}
      <tr>

        {% if part.material %}
        <td onclick="tdClick('{% url 'myequis:exchange-material-url' bicycle.id part.part.id %}');">
          {{ part.part.name }}
        </td>
        {% else %}
        <td onclick="tdClick('{% url 'myequis:mount-material-url' bicycle.id part.part.id %}');">
          {{ part.part.name }}
        </td>
        {% endif %}

        {% if part.material %}
        <td onclick="tdClick('{% url 'myequis:edit-material-url' part.material.id %}');">
          <div class="text-uppercase">
            {{ part.material.manufacture }}
          </div>
          <div class="font-weight-bold">
            <span>
              {{ part.material.name }}
            </span>
          </div>
          <div class="text-muted">
            <div>
              {{ part.material.comment }}
            </div>
            <div>
              {{ part.mounting.comment }}
            </div>
          </div>
        </td>
        {% else %}
        <td>{{ part.material.name }}</td>
        {% endif %}

        <td>{{ part.mounting.mount_record.date }}</td>
        <td>{{ part.distance }}</td>
      </tr>
      {% endfor %}
    </table>
    {% endfor%}
    {% else %}
    <p>No components yet</p>
    {% endif %}
  </div>
</div>

{% endblock %}
